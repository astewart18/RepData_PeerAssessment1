---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
Loading libraries that will be used later. The rubric specifically says to show all code, so echo will be left on.
```{r }
require(dplyr)
require(ggplot2)
```

## Loading and preprocessing the data
The file in the initial fork is in a zip archive in the current working directory. Extract and read it in.

Look at the structure of the data to get a feel for the preprocessing requried.

```{r }
data<-read.csv(unz("./activity.zip","activity.csv"))
str(data)

```
The interval column is an integer, with the hundreds representing the hour. This could be changed to a factor in the format hh:mm by the following code. 

```{r }
# data$interval<-as.factor(sprintf("%02d:%02d",
#                                  data$interval%/%100, 
#                                  data$interval%%100))
# class(data$interval)
# head(data,12)

```
however this spoils the look of the time series plot, which would no longer have a line. Leaving it as is means that that plot would be misleading, it would appear continuous but in fact there would be jumps of 40 minutes every hour. So instead it is converted to minutes as follows:
```{r }
data$interval<-data$interval%/%100*60+data$interval%%100
class(data$interval)
data[10:20,]
```
## What is mean total number of steps taken per day?
Summarise the data by day and produce a histogram of the total steps (with bin width of 1000).
```{r fig.width=10}
daily_data<-data %>% group_by(date) %>% summarise(steps=sum(steps))
ggplot(daily_data, aes(x=steps)) + geom_histogram(binwidth = 1000)
```


NA values are ignored in calculating the mean and median.
```{r }
mean_total_steps_per_day<-mean(daily_data$steps,na.rm=TRUE)
mean_total_steps_per_day
median_total_steps_per_day<-median(daily_data$steps,na.rm=TRUE)
median_total_steps_per_day
```
The mean total number of steps per days is calculated as `r sprintf("%f",mean_total_steps_per_day)` whereas the median is `r sprintf("%f",median_total_steps_per_day)`.

## What is the average daily activity pattern?

To make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis), the data is summarised by intervals.
```{r fig.width=10, dpi=150}
interval_data<-data %>% group_by(interval) %>% summarise(steps=mean(steps,na.rm=TRUE))
plot(interval_data,type="l",xlab="5 minute interval",xaxt = "n")
axis(1, at = c(0, 6*60, 12*60, 18*60,24*60),labels=c("midnight", "6am","noon", "6pm","midnight"))


```


The 5-minute interval, on average across all the days in the dataset, containing the maximum number of steps can be determined by sorting the interval dataset by steps decreasing and looking at the top one (amongst other methods):
```{r}
top_interval<-arrange(interval_data,desc(steps))[1,1]
top_interval
```
So the top interval starts at `r top_interval` minutes, in other words from  
`r paste0(top_interval%/%60,":",top_interval%%60)` to
`r paste0(top_interval%/%60,":",top_interval%%60+5)`.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
